# 2026-02-21 17:00 KST — coder hourly update (2nd pass)

## 이번 시간 작업 요약
이번 시간에는 미구현 상태였던 **`ensemble_3seed` 레버를 실제 실행 가능**하게 패치했습니다.

### 1) 구현한 레버 (실동작)
- 대상: `ensemble_3seed` (`configs/experiments/ensemble_3seed.yaml`)
- 변경 내용:
  - `configs/experiments/ensemble_3seed.yaml`
    - `enabled: true`
    - `note`를 구현 상태에 맞게 수정 (`3-seed prediction averaging ensemble`)
  - `scripts/run_experiment.py`
    - `runner=ensemble_3seed` 허용 (더 이상 SKIPPED/not implemented 아님)
    - `params.seeds`를 `training_extras.ensemble_seeds`로 전달
    - 기본값 `ensemble_seeds=[41,42,43]` 보정
  - `scripts/run_chgnet_mp_e_form.py`
    - `TrainConfig`에 `ensemble_seeds` 추가
    - fold별 추론 시 `ensemble_seeds`가 2개 이상이면:
      - seed마다 독립 학습/추론 수행
      - 멤버 예측값 평균으로 최종 예측 생성
      - 평균 예측을 `task.record()`에 기록

> 구현 방식은 “3개 seed 모델의 prediction averaging”으로, 기존 단일 모델 경로와 호환됩니다.

### 2) Colab 1-click 유지
- 노트북 Run all 흐름 변경 없음.
- 실험 리스트에 `ensemble_3seed`를 넣으면 기존 오케스트레이션(`scripts/run_experiment.py`) 경로로 실행됩니다.

### 3) 로깅 규칙 유지
- `metric_value` float 추출 로직 유지.
- `RESULTS.md` 라인 포맷 `METRIC=<float>` 유지.
- 이번 시간에는 코드 패치 중심으로, 장시간 실험 실행은 생략.

## 변경 파일
- `configs/experiments/ensemble_3seed.yaml`
- `scripts/run_experiment.py`
- `scripts/run_chgnet_mp_e_form.py`

## git diff --stat (이번 패치 범위)
```text
configs/experiments/ensemble_3seed.yaml |   4 +-
scripts/run_chgnet_mp_e_form.py         | 195 ++++++++++++++++++++++++++------
scripts/run_experiment.py               |  40 ++++++-
3 files changed, 199 insertions(+), 40 deletions(-)
```

## 테스트 방법
### 빠른 문법 확인
```bash
cd /Users/sungwoo/Desktop/Career/git/MALTbot
python3 -m py_compile scripts/run_experiment.py scripts/run_chgnet_mp_e_form.py
```

### 단건 실행 확인(ensemble 레버)
```bash
cd /Users/sungwoo/Desktop/Career/git/MALTbot
MALTBOT_DATE=2026-02-21 MALTBOT_BATCH_RUN_NAME=hourly-ens \
python3 scripts/run_experiment.py --exp-name ensemble_3seed
```

- 기대 결과:
  - `results/daily/2026-02-21/hourly-ens/ensemble_3seed/results.json` 생성
  - `metric_value` float 채워짐
  - `RESULTS.md`에 `METRIC=<float>` 한 줄 append

## 비고
- 커밋/푸시 없음 (로컬 변경만 유지).